<?phpnamespace app\common\model;class CartModel extends BaseModel{    public static function getList($input){        try{            $default = [                'sort'=>'id',                'order'=>'desc',                'offset'=>0,                'limit'=>null,            ];            $input = array_merge($default,$input);            $cart = self::field('a.*')->alias('a');            if(isset($input['id'])){                $cart->where('id',"=",$input['id']);            }            $cart->limit($input['offset'],$input['limit']);            $rows = $cart->select();            $count = $rows->count();            return ['code'=>1,'total' => $count,'rows'=>$rows];        }catch(\Exception $e) {            return array('code' => 0, 'rows' => [], 'msg' => $e->getMessage());        }    }    public static function appList($input){        try{            $default = [                'sort'=>'a.id',                'order'=>'desc',                'offset'=>0,                'limit'=>null,            ];            $input = array_merge($default,$input);            $join = [                ['product b','b.id = a.product_id','left'],            ];            $cart = self::field('a.*,b.name,b.label,b.img,b.abstract,b.price,b.vip_price,b.status')->alias('a')                ->join($join)                ->where('a.customer_id','=',$input['customer_id'])                ->order([$default['sort']=>$default['order']]);            $cart->limit($input['offset'],$input['limit']);            $rows = $cart->select();            $price_sum = 0;            $vip_price_sum = 0;            foreach ($rows as $k=>&$v){                $price_sum += $v['price']*$v['count'];                $vip_price_sum += $v['vip_price']*$v['count'];                $v['img'] = $v['img']?explode(',',$v['img'])[0]:'';            }            $count = $rows->count();            $sum = $cart->sum('count');            return ['code'=>1,'total' => $count,'sum'=>$sum,'rows'=>$rows,'price_sum'=>$price_sum,'vip_price_sum'=>$vip_price_sum];        }catch(\Exception $e) {            return array('code' => 0, 'rows' => [], 'msg' => $e->getMessage());        }    }    public static function countByCustomer($customer_id){        return CartModel::where(['customer_id'=>$customer_id])->sum('count');    }}