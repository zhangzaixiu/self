<?phpnamespace app\common\model;use app\common\ButtonElement;use app\common\model\BaseModel;use app\common\model\SysFileModel;use think\model\concern\SoftDelete;class EnterCategoryModel extends BaseModel{    use SoftDelete;    protected $deleteTime = 'delete_time';    public function getIsShowAttr($value,$data)    {        $status = [1=>'是',2=>'否'];        return $status[$data['is_show']];    }    public function getOperateAttr($value,$data){        return [            'show'=>ButtonElement::showLink(url('admin/enter_category/show',['id'=>$data['id']])),            'delete'=>ButtonElement::confirmButton(url('admin/enter_category/delete',['id'=>$data['id']]),'确定删除『'.$data['name'].'』吗?'),        ];    }    public static function getList($input){        try{            $default = [                'sort'=>'id',                'order'=>'desc',                'offset'=>0,                'limit'=>null,            ];            $input = array_merge($default,$input);            $category = self::field('*')->with('sys_file');            if(isset($input['name'])){                $category->whereLike('name',"%".$input['name']."%");            }            $category->order($input['sort'],$input['order']);            $category->limit($input['offset'],$input['limit']);            $rows = $category->select();            foreach ($rows as $k => &$v){               $v['operation'] = implode(' ',$v->operate);            }            $count = $category->count();            return ['code'=>1,'total' => $count,'rows'=>$rows];        }catch(\Exception $e) {            return array('code' => 0, 'rows' => [], 'msg' => $e->getMessage());        }    }    public function sysFile()    {        return $this->hasOne(SysFileModel::class,'id','img');    }    public static function getSelectArray(){        $category = self::where(['is_show'=>1])->order(['sort'=>'desc'])->field('id,name')->select()->toArray();        $name_list = [];        array_map(function($value) use (&$name_list){            $name_list[$value['id']] = $value['name'];        }, $category);        return $name_list;    }}