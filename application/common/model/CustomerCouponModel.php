<?phpnamespace app\common\model;class CustomerCouponModel extends BaseModel{    /**     * 定义别名字段     * @var array     */    public static $alia = [        'status'=>[            1=>'未使用',            2=>'已使用'        ],    ];    public function getStatusAttr($value)    {        return self::$alia['status'][$value];    }    /**     *获取列表信息     * @param $input     * @param string $field     * @return array     */    public static function appList($input){        try{            $default = [                'offset'=>0,                'limit'=>10,            ];            $input = array_merge($default,$input);            $join = [                ['coupon b','b.id = a.coupon_id','left'],                ['product_category c','c.id = b.product_category_id','left'],            ];            $coupon = self::field('a.*,b.name,b.coupon,b.price,b.product_category_id,b.start_time,b.end_time,c.name category_name')->alias('a')                ->join($join)                ->order(['a.status'=>'asc','a.id'=>'desc']);            if(isset($input['customer_id'])){                $coupon->where(['a.customer_id'=>$input['customer_id']]);            }            if(isset($input['status'])){                $coupon->where(['a.status'=>$input['status']]);            }            if(isset($input['pageNo'])){                $input['offset'] =($input['pageNo']-1)*10;            }            if(isset($input['end_time'])){                $coupon->where('b.end_time','>=',$input['end_time']);            }            $coupon->limit($input['offset'],$input['limit']);            $rows = $coupon->select();            $count = $coupon->count();            $pages = ceil($count/$input['limit']);            return ['code'=>1,'pages' => $pages,'pageList'=>indexBy($rows,'id')];        }catch(\Exception $e) {            return array('code' => 0, 'rows' => [], 'msg' => $e->getMessage());        }    }}