<?phpnamespace app\admin\model;use app\common\ButtonElement;use app\common\model\SysFileModel;use think\Model;class NewsModel extends Model{    public function getIsBannerAttr($value,$data)    {        $status = [1=>'是',0=>'否'];        return $status[$data['is_banner']];    }    public function getStatusAttr($value,$data)    {        $status = [1=>'草稿',2=>'发布'];        return $status[$data['status']];    }    public function getOperateAttr($value,$data){        return [            'banner'=>ButtonElement::confirmButton(url('admin/news/banner',['id'=>$data['id']]),'确定设置为banner吗?','设为banner','warning','wb-edit'),            'show'=>ButtonElement::showLink(url('admin/news/show',['id'=>$data['id']])),            'delete'=>ButtonElement::confirmButton(url('admin/news/delete',['id'=>$data['id']]),'确定删除吗?'),        ];    }    public static function getList($input){        try{            $default = [                'sort'=>'id',                'order'=>'desc',                'offset'=>0,                'limit'=>null,            ];            $input = array_merge($default,$input);            $banner = self::field('*')->with('sys_file');            if(isset($input['status'])){                $banner->where(['status'=>$input['status']]);            }            if(isset($input['title'])){                $banner->whereLike('title',"%".$input['title']."%");            }            $banner->order($input['sort'],$input['order']);            $banner->limit($input['offset'],$input['limit']);            $rows = $banner->select();            foreach ($rows as $k => &$v){               $v['operation'] = implode(' ',$v->operate);            }            $count = $banner->count();            return ['code'=>1,'total' => $count,'rows'=>$rows];        }catch(\Exception $e) {            return array('code' => 0, 'rows' => [], 'msg' => $e->getMessage());        }    }    public function sysFile()    {        return $this->hasOne(SysFileModel::class,'id','img');    }//    /**//     * 列表信息//     * @param $input//     * @return array//     *///    public static function getList($input){//        try{//            $data = $input;//            $con = [];//            $limit = 10;//            $offset = 0;//            if(!empty($data['limit'])){//                $limit=$data['limit'];//            }//            if(!empty($data['offset'])){//                $offset=$data['offset'];//            }//            if(!empty($data['id'])){//                $con['a.id']= $data['id'];//            }//            if(!empty($data['title'])){//                $con['a.title']= ['like','%'.$data['title'].'%'];//            }//            if(!empty($data['status'])){//                $con['a.status']= $data['status'];//            }////            $join = [//                ['sys_file b', 'a.img = b.id  and b.isDelete = 0', 'left'],//            ];//            $list = getDataList('News', $con, 'a.*,b.savePath',"addtime desc",$join,'', $limit, $offset);//            if ($list['code'] == 0) {//                throw new \think\Exception($list['msg']);//            }//            foreach ($list['data'] as $k =>$v){//                $list['data'][$k]['add_date'] = date('Y-m-d h:i:s',$v['addtime']);//                $list['data'][$k]['status_alias'] = $v['status'] == 2?'发布':'草稿';//                $list['data'][$k]['banner_alias'] = $v['is_banner'] == 1?'是':'否';//            }//            $count = getRecordNum('News', $con,$join);//            return ['code'=>1,'total' => $count,'rows'=>$list['data']];//        }catch(\Exception $e) {//            c_Log($e);//            return array('code' => 0, 'rows' => [], 'msg' => $e->getMessage());//        }//    }}