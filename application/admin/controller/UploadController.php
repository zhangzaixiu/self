<?phpnamespace app\admin\controller;use app\common\model\SysFileModel;use think\Controller;class UploadController extends Controller{    //上传    public function ajaxUploads()    {        $validate = [];        $validate['ext'] = input("ext");        $validate['size'] = input("size")* 1024 * 1024;        $directory = input("dir");        $tmppath =  "/files/" . $directory;        $savename = session("userId") . "-" . time() . "-" . rand(1, 100000);        $file = request()->file('file');        if(empty($file)){            return json(['code'=>0,'msg'=>'文件上传失败']);        }        $info = $file->validate($validate)->move( \think\facade\Env::get('ROOT_PATH'). 'public' .$tmppath,$savename);        if($info){            $name = $info->getInfo();            $model = new SysFileModel();            $fileName = $name['name'];            $model->name = $fileName;            $model->save_path = $tmppath.'/'.$info->getFilename();            $model->save_name = $info->getFilename();            $model->exts = $info->getExtension();            $model->size = $info->getSize();            $model->user_id = session("userId");            if($model->save()){                $result["id"] = $model->id;                $result['code'] = 1;                $result["path"] = $model->save_path;                $result["fileName"] = $fileName;                return json($result);            }else{                return json(['code'=>0,'msg'=>'文件保存失败']);            }        }else{            return json(['code'=>0,'msg'=>$file->getError()]);        }    }}