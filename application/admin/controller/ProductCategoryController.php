<?phpnamespace app\admin\controller;use app\admin\model\FrontendMessageCategoryModel;use app\common\model\ProductCategoryModel;class ProductCategoryController extends  BaseController{    /**     * 列表页     * @return \think\response\Json|\think\response\View     */    public function index()    {        $this->view->engine->layout(true);        $data = input('','','trim');        $search = [];        if(!empty($data)){            $search = filter_array($data);        }//        var_dump($search);die;        $tree = ProductCategoryModel::tree($search);//        var_dump($tree);die;        if ($tree['code'] == 1) {            $tree_view = ProductCategoryModel::treeView($tree['data']);            $alias = ProductCategoryModel::$alia;//            var_dump($tree_view);die;            return view('', ['data' => $tree_view,'alias'=>$alias]);        } else {            return view('layout/message', ['data' => $tree['msg']]);        }    }    /**     * 创建     * @return \think\response\Json|\think\response\View     */    public function create(){        if(\think\facade\Request::isPost()){            try {                $data = input('post.','','trim');                $this->validate($data, 'FrontendMessageCategory');                $banner = new FrontendMessageCategoryModel($data);                if(!$banner->save()){                    throw new \think\Exception('分类添加失败');                }                $result['msg'] = '分类添加成功';                $result['success'] = true;                return json($result);            } catch (\Exception $e) {                return json(['success' => false, 'msg' => $e->getMessage(), 'data' => []]);            }        }        return view('');    }    /**     * 展示     * @return \think\response\Json|\think\response\View     */    public function edit(){        $id = input('id');        try {            if(empty($id)){                throw new \think\Exception('错误请求');            }            $category = FrontendMessageCategoryModel::get($id);            if(empty($category)){                throw new \think\Exception('分类不存在');            }            if(\think\facade\Request::isPost()){                try {                    $data = input('','','trim');                    $this->validate($data, 'FrontendMessageCategory');                    if(!$category->force()->save( $data)){                        throw new \think\Exception('编辑失败');                    }                    $result['msg'] = '编辑成功';                    $result['success'] = true;                    return json($result);                } catch (\Exception $e) {                    return json(['success' => false, 'msg' => $e->getMessage(), 'data' => []]);                }            }else{                return  view('',['data'=>$category]);            }        } catch (\Exception $e) {            return  view('layout/message',['msg'=>$e->getMessage()]);        }    }}